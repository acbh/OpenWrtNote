### 0. **笔记**

#### 带宽

**网络带宽：**

​	网络连接的速率或数据传输速率，通常以比特每秒（bps，bits per second）为单位。常见的单位包括：

- Kbps（千比特每秒）
- Mbps（兆比特每秒）
- Gbps（吉比特每秒）

**带宽类型：**

* **对称带宽**：上行带宽和下行带宽相等。例如，某些企业级网络连接会提供对称的100 Mbps上传和下载带宽。

* **非对称带宽**：上行带宽和下行带宽不相等。家用宽带通常具有较高的下载带宽，但上传带宽较低，例如100 Mbps下载，10 Mbps上传。

#### 计算

1 Mbps（兆比特每秒）表示数据传输速率，但要转换为MB（兆字节），需要理解比特（bit）与字节（byte）之间的关系。

**关系**：
- 1 Byte = 8 bits

因此，要将 Mbps 转换为 MBps（兆字节每秒），可以使用以下公式：
$$
\text{MBps} = \frac{\text{Mbps}}{8}
$$

**计算**：

$$
1 \text{Mbps} = \frac{1}{8} \text{MBps} = 0.125 \text{MBps}
$$

**结论**：
$$
1 \text{Mbps} = 0.125 \text{MBps}
$$
也就是说，1 Mbps 的数据传输速率相当于每秒传输 0.125 MB 的数据。

#### bmon工具

bmon: Bandwidth Monitor, 监控网络带宽和性能工具，方便查看查看网络接口的实时流量、带宽利用率、数据包统计等信息

安装：`sudo apt-get install bmon`, 使用：`bmon`

#### 



### 1. **实现一对多带宽测试程序**

   - **服务器端**:
     1. 创建一个TCP或UDP服务器，监听某个端口。
     
     2. 当多个客户端连接时，服务器同时与多个客户端进行数据通信，记录各个客户端的带宽情况。
     
     3. 实现数据统计功能，每隔一定时间计算一次带宽。
     
   - **客户端**:
     1. 客户端连接到服务器，发送和接收数据。
     2. 根据发送和接收的数据量计算当前带宽。
     3. 定期将带宽信息发送回服务器，或者服务器请求时返回当前带宽。

### 2. 界面主要功能

#### 界面信息

```
Server addr: 	192.168.166.100		port: 8888
broadcast addr: 192.168.166.255		port: 5005
test time:		500 sec			pakg size:	1400 bit
mode: double 					limit: no limit

pre		next 	set limit exit
Connected device: 0	 	Run time: 0 	Page:0
-------------------------------------------------------
UP		0.00 Mbps 		DOWN 			0.00 Mbps

Max bw: 	0.00 	| 	Max bw 		: 	0.00
Min bw: 	0.00 	| 	Min bw 		: 	0.00
Average bw:	0.00    |   Average bw  : 	0.00

| RANK | IP 		|PORT | UP 		| DOWN 			|
```

#### 连接列表 支持翻页

共12个客户端

#### 限速 限速后实际速度与bmon监控的速度一致



### 3. **集成到LuCI界面**

   - **编写 LuCI 界面代码**:
     1. 编写对应的 Lua 脚本来控制界面展示。
     2. 创建一个新页面来展示实时带宽测试结果。
     3. 编写前端代码通过 AJAX 从服务器获取实时数据，并动态更新界面。

   - **后端数据接口**:
     1. 编写一个 Lua 脚本或使用 CBI 来处理带宽测试数据的请求。
     2. 定期从带宽测试程序获取最新的测试结果，并通过接口提供给前端页面。

### 4. **实时数据显示**

   - **实现实时数据更新**:
     1. 在前端页面使用JavaScript的`setInterval`方法定期向后端发送请求获取最新带宽数据。
     2. 获取数据后，通过 DOM 操作动态更新页面元素，展示最新的带宽测试结果。

   - **展示图表**:
     1. 为了更直观地展示数据，可以使用图表库如 `Chart.js`、`ECharts` 等来绘制实时带宽数据图表。

### 5. **测试和调试**

   - 部署到 OpenWrt 环境中，测试整个程序的功能。
   - 调试前后端通信，确保数据能实时更新并展示。
